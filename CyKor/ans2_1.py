from z3 import *
from math import gcd
from Crypto.Util.number import bytes_to_long,long_to_bytes,inverse
n1 = 0xa456a39539944743ea1a81093e14aa1da4d4bbd6041b0764c7b853bfacc77603f1b59342a9df52f3c53870dcc762bc701dc3e38fe2ae49866fa78e312d37617f74b2bc7e60855e6d5f92b35431ea686a0e4e027748e32e70bd38faa2cf695893e03eb2631e232896a04980af9b39324864e514f743468e6aafa3f67915e7f47f2c1527fa11ae129441f18c13d5f424d7fdae5914691bd0f6310d8eb7db2af9b85f584871d27c89fb5aeff5d00ca8f1e661676b546a3cf59751724193d93e0fe7db28e81e5b8aa060d6c1876d0454ef772d6388fb2fc3569af911793fc26f51303a02d66448f58f356e74799c5385d00eda9c59dda603c9c86eb6d8ebaa060d15
phi1=0xa456a39539944743ea1a81093e14aa1da4d4bbd6041b0764c7b853bfacc77603f1b59342a9df52f3c53870dcc762bc701dc3e38fe2ae49866fa78e312d37617f74b2bc7e60855e6d5f92b35431ea686a0e4e027748e32e70bd38faa2cf695893e03eb2631e232896a04980af9b39324864e514f743468e6aafa3f67915e7f47d8f1063558b68e28985a4a6d8df8e2e53572023dbec8fbd5c8174b5f39ffca536c7737c687c4ca29af33a431f4d8d4fd676e0cc0eb13a85a1fc11b2fddf49ff8a48ccb09d2de4a654d91fa002921af0d6852f6f5fd7855a8aeed286571d779754e9a74e875c9b11fd7cb172f3149c4f864e4681a459a85ca5ebac6f4128c1a9e0
n2 = 0x9744f6666b02c81a23cbd30fa4b5b97c6840013a4900e653e1c2c3c6fd3cb78d271e97eec5dfd2a918086c0a56eb8835fb3866e1ce80e30ea2bfb75ed8d6e18b34c7c8f9768db20a51d0e5de506e52e782b167716c701e86edc5f28396258e6a4b68ef65e82bd7ba5a7db38675b854577493dc45b64f73ad51e630c413c835ca3e0c1fcf67c87ab5c0a7d920aa2a981b749ab421e4f5164e04c477b95e130de5935c0a1182a715086686d6819232175e1b7f3543d00f6517ad37018219072b6af840dbfb0ab1dd1cd93d7a61d84a56ea23fbf9c2404d606613d19c5a2641832881e6aab46c551d41da71bafe184f0ba5f7550bc9eafb890bcbe371870b14d5eb
c = 0x3dbc0ebf35a9f231e61edd4614df3efca5a1a30ae82057c472f5eb0aa8e4b0b82a7bcc6db2cb6d6de519aa502d05a82179780812c7dee0d8c2d6b53435020bbf824b37b670c6be7e92cf5d298e8f1978ebd2b5e52e2cfc3479acf1eb7cd377051d4431afc66f4b282b138815709013a1343c40267f043a22a40af05c372fb89b41e0ee3b82b928d9961da4f65b90e825368677267d23149e557a899cb394af7e4998104051ff1de1b0dad79e3c0bb3dafa3ea04d8199b063f8fd1559c060ba8a5fa96898d80142fab921359bee881963584a404aeb50482f5daf7134e2caf22684b17240575d2a145cbe9dd78bd0ae62c231f8b68c070053eb2b78e0a3a5430a
e = bytes_to_long(b'KOREA_2020')


x = Int('x')
s = Solver()

a = phi1 - n1 - 1
b = n1
#print(a,b)

s.add(x*x-290031542064022331722106086956658513397120077924601390158383796464887614544244083627382357298295671036767334012600881553109280489895457621486213803908402851131157829319554203873279043130097185463890918956410138880223877986031539335811031181098318060944871253626693839523349601920713468264334794993687863780150*x + 20745805295552270130256496184563288684568733009391527485153264844332794778593765508698814647446443893906566502764078296278788312079707840991868330065942723916780836921818388254112803361681003595491648947010693621416045260649545692011188804103031477749732961527784060445526851629118687575285137010020024170809437963143486647215714917315375230343149799611929753170430437345878088992296671077657831815767732328520084599833181837438552570211176282130123647164604706339748547433255938530826998623462718486756743208925939447359624551842223720378952450974447278834439247290569785883754670123771755167308857272152902477417749 == 0 )

s.check()
#print (s.model())
# x = 128170339827781970865756502516967705182132901909586491864292796647780540235457716578019540592754500299048806635886188146038152633179419685697100574047217112168747636506437741327800664611342493354456642088455367340380850963814687923708040498176095349608934933620301938816991206084504187221843261521697302738701



p = 128170339827781970865756502516967705182132901909586491864292796647780540235457716578019540592754500299048806635886188146038152633179419685697100574047217112168747636506437741327800664611342493354456642088455367340380850963814687923708040498176095349608934933620301938816991206084504187221843261521697302738701
q = n1 // p
assert p * q == n1

if(n2 % (p+2) == 0 ):
    p2 = p + 2
else:
    p2 = q + 2
    
assert n2 % p2 == 0
q2 = n2 // p2
phi2 = (p2-1) * (q2 - 1)

assert p2 * q2 == n2
e2 = e // 16
print(pow(c,inverse(e2,phi2),n2))

plain = 37 * 4221499 * 115905467 * 5529411623459399463979
print (long_to_bytes(plain))
n = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141
flagHash = 'bd918e65d9932b2b0ba409bc3312810838e70a868b39cec95d739d1c3023cba6'
msg1 = 96635206108390296763573263992932790643677468206287942451543983148412434727677
msg2 = 65508017016579802842576370293779793942377062671698588481235391123426555618237
r1, s1 = 80836404935566921682417672387907429880343515257791680366663964930631647176103, 46168989196478948079683325523825491241233176909280840986890215301952583949505
r2, s2 = 68542139994904942940574297180148558033406241028981806648794627432045016152755, 27446974724847813723500755762853534060093590439943863889267967939886124040380

#k * s1 = msg1 + r1 * secret
#k^3 * s2 = msg2 + r2 * secret

#s2 * k^3 * s1^3 = s2 * (msg1 + r1 * secret) ^ 3
#s1^3 * k^3 * s2 = s1^3 *(msg2 + r2 * secret)
    
Pr.<x> = PolynomialRing(Zmod(n))

f = s2 * (msg1 + r1 * x) ** 3 - (s1 ** 3) * (msg2 + r2 * x) 

answer = f.roots()

from hashlib import sha256

for a, _ in answer:
    a = int(a).to_bytes(32, byteorder= 'little')
    hash = sha256(a).hexdigest()
    if hash == 'bd918e65d9932b2b0ba409bc3312810838e70a868b39cec95d739d1c3023cba6':
        print(f'FLAG{{{a.hex()}}}')
